{{ 'rk-feature-analytics.css' | asset_url | stylesheet_tag }}

<section class="rk-feature-analytics" data-section-id="{{ section.id }}">
  <div class="rk-feature-analytics__container">
    <div class="rk-feature-analytics__header">
      {% if section.settings.eyebrow != blank %}
        <span class="rk-feature-analytics__eyebrow">{{ section.settings.eyebrow }}</span>
      {% endif %}
      <h2 class="rk-feature-analytics__heading">{{ section.settings.heading }}</h2>
      {% if section.settings.subheading != blank %}
        <p class="rk-feature-analytics__subheading">{{ section.settings.subheading }}</p>
      {% endif %}
    </div>

    <div class="rk-feature-analytics__dashboard">
      <div class="rk-feature-analytics__metrics-bar">
        <div class="rk-feature-analytics__metric-card">
          <div class="rk-feature-analytics__metric-icon">ğŸ“Š</div>
          <div class="rk-feature-analytics__metric-value" data-value="24563">24,563</div>
          <div class="rk-feature-analytics__metric-label">Recipe Views</div>
          <div class="rk-feature-analytics__metric-change">+18%</div>
        </div>
        <div class="rk-feature-analytics__metric-card">
          <div class="rk-feature-analytics__metric-icon">â¤ï¸</div>
          <div class="rk-feature-analytics__metric-value" data-value="89">89%</div>
          <div class="rk-feature-analytics__metric-label">Engagement Rate</div>
          <div class="rk-feature-analytics__metric-change">+5%</div>
        </div>
        <div class="rk-feature-analytics__metric-card">
          <div class="rk-feature-analytics__metric-icon">ğŸ’¾</div>
          <div class="rk-feature-analytics__metric-value" data-value="3421">3,421</div>
          <div class="rk-feature-analytics__metric-label">Recipes Saved</div>
          <div class="rk-feature-analytics__metric-change">+32%</div>
        </div>
        <div class="rk-feature-analytics__metric-card">
          <div class="rk-feature-analytics__metric-icon">ğŸ’°</div>
          <div class="rk-feature-analytics__metric-value" data-value="45231">$45,231</div>
          <div class="rk-feature-analytics__metric-label">Revenue Generated</div>
          <div class="rk-feature-analytics__metric-change">+24%</div>
        </div>
      </div>

      <div class="rk-feature-analytics__panels">
        <div class="rk-feature-analytics__panel rk-feature-analytics__panel--chart">
          <h3 class="rk-feature-analytics__panel-title">Popular Recipes</h3>
          <div class="rk-feature-analytics__chart">
            <div class="rk-feature-analytics__bar" style="--height: 90%">
              <span class="rk-feature-analytics__bar-label">Cookies</span>
              <span class="rk-feature-analytics__bar-value">892</span>
            </div>
            <div class="rk-feature-analytics__bar" style="--height: 75%">
              <span class="rk-feature-analytics__bar-label">Brownies</span>
              <span class="rk-feature-analytics__bar-value">734</span>
            </div>
            <div class="rk-feature-analytics__bar" style="--height: 60%">
              <span class="rk-feature-analytics__bar-label">Cake</span>
              <span class="rk-feature-analytics__bar-value">612</span>
            </div>
            <div class="rk-feature-analytics__bar" style="--height: 45%">
              <span class="rk-feature-analytics__bar-label">Bread</span>
              <span class="rk-feature-analytics__bar-value">445</span>
            </div>
            <div class="rk-feature-analytics__bar" style="--height: 30%">
              <span class="rk-feature-analytics__bar-label">Muffins</span>
              <span class="rk-feature-analytics__bar-value">298</span>
            </div>
          </div>
        </div>

        <div class="rk-feature-analytics__panel rk-feature-analytics__panel--insights">
          <h3 class="rk-feature-analytics__panel-title">Customer Insights</h3>
          <div class="rk-feature-analytics__insights">
            <div class="rk-feature-analytics__insight">
              <div class="rk-feature-analytics__insight-icon">ğŸ¥—</div>
              <div class="rk-feature-analytics__insight-text">
                <strong>42% prefer healthy recipes</strong>
                <span>Up from 35% last month</span>
              </div>
            </div>
            <div class="rk-feature-analytics__insight">
              <div class="rk-feature-analytics__insight-icon">ğŸ”</div>
              <div class="rk-feature-analytics__insight-text">
                <strong>Top search: "gluten-free"</strong>
                <span>1,234 searches this week</span>
              </div>
            </div>
            <div class="rk-feature-analytics__insight">
              <div class="rk-feature-analytics__insight-icon">â°</div>
              <div class="rk-feature-analytics__insight-text">
                <strong>Peak time: 6-8 PM</strong>
                <span>65% of daily traffic</span>
              </div>
            </div>
            <div class="rk-feature-analytics__insight">
              <div class="rk-feature-analytics__insight-icon">ğŸ“±</div>
              <div class="rk-feature-analytics__insight-text">
                <strong>73% mobile users</strong>
                <span>Optimize for mobile first</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="rk-feature-analytics__recommendations">
        <h3 class="rk-feature-analytics__recommendations-title">
          <span class="rk-feature-analytics__ai-badge">AI</span>
          Recommended Actions
        </h3>
        <div class="rk-feature-analytics__recommendation-cards">
          {% for block in section.blocks %}
            <div class="rk-feature-analytics__recommendation" {{ block.shopify_attributes }}>
              <div class="rk-feature-analytics__recommendation-icon">{{ block.settings.icon }}</div>
              <div class="rk-feature-analytics__recommendation-content">
                <h4>{{ block.settings.title }}</h4>
                <p>{{ block.settings.description }}</p>
              </div>
              <div class="rk-feature-analytics__recommendation-impact">
                {{ block.settings.impact }}
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>

    <div class="rk-feature-analytics__benefits">
      <div class="rk-feature-analytics__benefit">
        <span class="rk-feature-analytics__benefit-icon">ğŸ“Š</span>
        <strong>Real-time Dashboard</strong>
      </div>
      <div class="rk-feature-analytics__benefit">
        <span class="rk-feature-analytics__benefit-icon">ğŸ¯</span>
        <strong>Customer Insights</strong>
      </div>
      <div class="rk-feature-analytics__benefit">
        <span class="rk-feature-analytics__benefit-icon">ğŸ“ˆ</span>
        <strong>Performance Tracking</strong>
      </div>
      <div class="rk-feature-analytics__benefit">
        <span class="rk-feature-analytics__benefit-icon">ğŸ’¡</span>
        <strong>AI Recommendations</strong>
      </div>
      <div class="rk-feature-analytics__benefit">
        <span class="rk-feature-analytics__benefit-icon">ğŸ“±</span>
        <strong>Mobile Analytics</strong>
      </div>
      <div class="rk-feature-analytics__benefit">
        <span class="rk-feature-analytics__benefit-icon">ğŸ“§</span>
        <strong>Weekly Reports</strong>
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const section = document.querySelector('[data-section-id="{{ section.id }}"]');
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          // Animate numbers
          const values = entry.target.querySelectorAll('.rk-feature-analytics__metric-value');
          values.forEach(value => {
            const target = parseInt(value.dataset.value) || 0;
            const isPercent = value.textContent.includes('%');
            const isDollar = value.textContent.includes('$');
            let current = 0;
            const increment = target / 50;
            
            const timer = setInterval(() => {
              current += increment;
              if (current >= target) {
                current = target;
                clearInterval(timer);
              }
              
              let display = Math.floor(current).toLocaleString();
              if (isDollar) display = '$' + display;
              if (isPercent) display = display + '%';
              value.textContent = display;
            }, 30);
          });
          
          // Animate bars
          const bars = entry.target.querySelectorAll('.rk-feature-analytics__bar');
          bars.forEach((bar, index) => {
            setTimeout(() => {
              bar.classList.add('rk-feature-analytics__bar--visible');
            }, index * 100);
          });
          
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.3 });
    
    observer.observe(section);
  });
</script>

{% schema %}
{
  "name": "RK Analytics",
  "settings": [
    {
      "type": "text",
      "id": "eyebrow",
      "label": "Eyebrow Text",
      "default": "Analytics & Insights"
    },
    {
      "type": "richtext",
      "id": "heading",
      "label": "Heading",
      "default": "<p>Know What Your <em>Customers Love</em></p>"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subheading",
      "default": "Get deep insights into customer preferences and behavior with powerful recipe analytics that drive smarter decisions."
    }
  ],
  "blocks": [
    {
      "type": "recommendation",
      "name": "Recommendation",
      "settings": [
        {
          "type": "text",
          "id": "icon",
          "label": "Icon (Emoji)",
          "default": "ğŸ³"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Recommendation Title",
          "default": "Create more breakfast recipes"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "Morning recipes get 3x more engagement"
        },
        {
          "type": "text",
          "id": "impact",
          "label": "Impact Badge",
          "default": "High Impact"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "RK Analytics",
      "blocks": [
        {
          "type": "recommendation",
          "settings": {
            "icon": "ğŸ³",
            "title": "Create more breakfast recipes",
            "description": "Morning recipes get 3x more engagement",
            "impact": "High Impact"
          }
        },
        {
          "type": "recommendation",
          "settings": {
            "icon": "ğŸ„",
            "title": "Feature seasonal ingredients",
            "description": "Holiday recipes trending now",
            "impact": "Trending"
          }
        },
        {
          "type": "recommendation",
          "settings": {
            "icon": "ğŸ¥",
            "title": "Add video to top recipes",
            "description": "Videos increase conversion by 45%",
            "impact": "Quick Win"
          }
        },
        {
          "type": "recommendation",
          "settings": {
            "icon": "ğŸ“±",
            "title": "Optimize for mobile users",
            "description": "73% of your traffic is mobile",
            "impact": "Priority"
          }
        }
      ]
    }
  ]
}
{% endschema %}