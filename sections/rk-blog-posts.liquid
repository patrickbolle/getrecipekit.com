{{ 'rk-blog-posts.css' | asset_url | stylesheet_tag }}

<section class="rk-blog-posts rk-blog-posts--{{ section.settings.layout_type }}" data-section-id="{{ section.id }}">
  <div class="rk-blog-posts__container">
    <div class="rk-blog-posts__header">
      {% if section.settings.heading != blank %}
        <h2 class="rk-blog-posts__heading">{{ section.settings.heading }}</h2>
      {% endif %}
      {% if section.settings.description != blank %}
        <p class="rk-blog-posts__description">{{ section.settings.description }}</p>
      {% endif %}
      {% if section.settings.view_all_link != blank %}
        <a href="{{ section.settings.view_all_link }}" class="rk-blog-posts__view-all">
          View all guides
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 8h6M8 5l3 3-3 3"/>
          </svg>
        </a>
      {% endif %}
    </div>

    {% if section.settings.show_featured and section.blocks.size > 0 %}
      {% assign featured_block = section.blocks.first %}
      <div class="rk-blog-posts__featured">
        <article class="rk-blog-posts__featured-card">
          {% if featured_block.settings.image != blank %}
            <div class="rk-blog-posts__featured-image">
              {{ featured_block.settings.image | image_url: width: 800 | image_tag: 
                loading: 'lazy',
                class: 'rk-blog-posts__image'
              }}
              <span class="rk-blog-posts__featured-badge">Featured Guide</span>
            </div>
          {% endif %}
          <div class="rk-blog-posts__featured-content">
            {% if featured_block.settings.category != blank %}
              <span class="rk-blog-posts__category">{{ featured_block.settings.category }}</span>
            {% endif %}
            <h3 class="rk-blog-posts__featured-title">
              <a href="{{ featured_block.settings.link }}">{{ featured_block.settings.title }}</a>
            </h3>
            {% if featured_block.settings.excerpt != blank %}
              <p class="rk-blog-posts__featured-excerpt">{{ featured_block.settings.excerpt }}</p>
            {% endif %}
            <div class="rk-blog-posts__meta">
              {% if featured_block.settings.author_image != blank %}
                {{ featured_block.settings.author_image | image_url: width: 40 | image_tag: 
                  class: 'rk-blog-posts__author-avatar'
                }}
              {% endif %}
              <div class="rk-blog-posts__meta-text">
                {% if featured_block.settings.author != blank %}
                  <span class="rk-blog-posts__author">{{ featured_block.settings.author }}</span>
                {% endif %}
                {% if featured_block.settings.read_time != blank %}
                  <span class="rk-blog-posts__read-time">{{ featured_block.settings.read_time }} min read</span>
                {% endif %}
              </div>
            </div>
          </div>
        </article>
      </div>
    {% endif %}

    <div class="rk-blog-posts__grid">
      {% for block in section.blocks %}
        {% if section.settings.show_featured == false or forloop.index > 1 %}
          <article class="rk-blog-posts__card" {{ block.shopify_attributes }}>
            {% if block.settings.image != blank %}
              <div class="rk-blog-posts__card-image">
                {{ block.settings.image | image_url: width: 400 | image_tag: 
                  loading: 'lazy',
                  class: 'rk-blog-posts__image'
                }}
                {% if block.settings.category != blank %}
                  <span class="rk-blog-posts__category rk-blog-posts__category--overlay">{{ block.settings.category }}</span>
                {% endif %}
              </div>
            {% endif %}
            <div class="rk-blog-posts__card-content">
              {% if block.settings.category != blank and block.settings.image == blank %}
                <span class="rk-blog-posts__category">{{ block.settings.category }}</span>
              {% endif %}
              <h3 class="rk-blog-posts__card-title">
                <a href="{{ block.settings.link }}">{{ block.settings.title }}</a>
              </h3>
              {% if block.settings.excerpt != blank %}
                <p class="rk-blog-posts__card-excerpt">{{ block.settings.excerpt }}</p>
              {% endif %}
              <div class="rk-blog-posts__card-footer">
                <div class="rk-blog-posts__meta">
                  {% if block.settings.author_image != blank %}
                    {{ block.settings.author_image | image_url: width: 32 | image_tag: 
                      class: 'rk-blog-posts__author-avatar rk-blog-posts__author-avatar--small'
                    }}
                  {% endif %}
                  <div class="rk-blog-posts__meta-text">
                    {% if block.settings.author != blank %}
                      <span class="rk-blog-posts__author">{{ block.settings.author }}</span>
                    {% endif %}
                    {% if block.settings.date != blank %}
                      <span class="rk-blog-posts__date">{{ block.settings.date }}</span>
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
          </article>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "RK Blog Posts",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Learn & Grow"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Section Description",
      "default": "Tips, guides, and success stories from the Recipe Kit community"
    },
    {
      "type": "url",
      "id": "view_all_link",
      "label": "View All Link"
    },
    {
      "type": "select",
      "id": "layout_type",
      "label": "Layout Type",
      "options": [
        {"value": "grid", "label": "Grid"},
        {"value": "carousel", "label": "Carousel"},
        {"value": "magazine", "label": "Magazine"}
      ],
      "default": "grid"
    },
    {
      "type": "checkbox",
      "id": "show_featured",
      "label": "Show Featured Post",
      "default": true,
      "info": "First blog post will be featured"
    }
  ],
  "blocks": [
    {
      "type": "blog_post",
      "name": "Blog Post",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Featured Image"
        },
        {
          "type": "text",
          "id": "category",
          "label": "Category",
          "default": "Guide"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "How to Create Recipes That Convert"
        },
        {
          "type": "textarea",
          "id": "excerpt",
          "label": "Excerpt",
          "default": "Learn the secrets to creating mouth-watering recipes that drive sales and engagement."
        },
        {
          "type": "url",
          "id": "link",
          "label": "Post Link"
        },
        {
          "type": "text",
          "id": "author",
          "label": "Author Name",
          "default": "Sarah Johnson"
        },
        {
          "type": "image_picker",
          "id": "author_image",
          "label": "Author Avatar"
        },
        {
          "type": "text",
          "id": "date",
          "label": "Date",
          "default": "Nov 15, 2024"
        },
        {
          "type": "text",
          "id": "read_time",
          "label": "Read Time (minutes)",
          "default": "5"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "RK Blog Posts",
      "blocks": [
        {
          "type": "blog_post",
          "settings": {
            "category": "SEO Guide",
            "title": "Recipe SEO: Rank #1 on Google",
            "excerpt": "Master the art of recipe SEO with our comprehensive guide to structured data and rich results.",
            "author": "Sarah Johnson",
            "date": "Nov 15, 2024",
            "read_time": "7"
          }
        },
        {
          "type": "blog_post",
          "settings": {
            "category": "Success Story",
            "title": "How Sweet Treats Co. Increased Sales by 300%",
            "excerpt": "Discover how this bakery transformed their business with shoppable recipes.",
            "author": "Mike Chen",
            "date": "Nov 12, 2024",
            "read_time": "5"
          }
        },
        {
          "type": "blog_post",
          "settings": {
            "category": "Tutorial",
            "title": "Creating Your First Recipe in 5 Minutes",
            "excerpt": "Step-by-step guide to publishing your first professional recipe card.",
            "author": "Emma Wilson",
            "date": "Nov 10, 2024",
            "read_time": "3"
          }
        }
      ]
    }
  ]
}
{% endschema %}